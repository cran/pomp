
R version 2.10.1 (2009-12-14)
Copyright (C) 2009 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(pomp)
Loading required package: deSolve
Loading required package: subplex
Loading required package: mvtnorm
> 
> data(ou2)
> 
> set.seed(1066L)
> 
> po <- ou2
> coef(po,c("x1.0","x2.0","alpha.1","alpha.4")) <- c(0,0,0.1,0.2)
> po <- simulate(po)
> guess <- p.truth <- coef(po)
> 
> m1 <- nlf(
+           object=po,
+           start=guess,
+           lags=c(1,2),
+           nconverge=100,
+           nasymp=1000,
+           trace=1,
+           verbose=TRUE,
+           eval.only=TRUE,
+           lql.frac = 0.025
+           )
> 
> print(m1)
[1] -391.5853
> 
> m1 <- nlf(
+           object=po,
+           start=guess,
+           est=c("alpha.1","alpha.4"),
+           lags=c(1,2),
+           nconverge=100,
+           nasymp=1000,
+           method="Nelder-Mead",
+           maxit=500,
+           trace=1,
+           verbose=TRUE,
+           lql.frac = 0.025
+           )
  Nelder-Mead direct search function minimizer
function value for initial parameters = 391.585287
  Scaled convergence tolerance is 5.83508e-06
Stepsize computed as 0.020000
BUILD              3 391.822251 391.585287
EXTENSION          5 391.776151 391.437121
EXTENSION          7 391.585287 390.985005
EXTENSION          9 391.437121 390.705228
EXTENSION         11 390.985005 389.914394
LO-REDUCTION      13 390.705228 389.914394
REFLECTION        15 390.162389 389.691267
EXTENSION         17 389.914394 389.155652
LO-REDUCTION      19 389.691267 389.155652
EXTENSION         21 389.331663 388.843884
REFLECTION        23 389.155652 388.683945
LO-REDUCTION      25 388.843884 388.683945
LO-REDUCTION      27 388.824168 388.683945
REFLECTION        29 388.701174 388.673612
HI-REDUCTION      31 388.683945 388.665874
REFLECTION        33 388.673612 388.656432
LO-REDUCTION      35 388.665874 388.656054
LO-REDUCTION      37 388.656432 388.654115
HI-REDUCTION      39 388.656054 388.651779
HI-REDUCTION      41 388.654115 388.650952
LO-REDUCTION      43 388.651779 388.650931
HI-REDUCTION      45 388.650952 388.650792
HI-REDUCTION      47 388.650931 388.650773
HI-REDUCTION      49 388.650792 388.650754
HI-REDUCTION      51 388.650773 388.650704
LO-REDUCTION      53 388.650754 388.650704
HI-REDUCTION      55 388.650718 388.650704
HI-REDUCTION      57 388.650715 388.650704
REFLECTION        59 388.650710 388.650703
Exiting from Nelder Mead minimizer
    61 function evaluations used
h in NLF =  0.1 
epsilon in NLF = 0.3450102 0.291259 
Fitted param  1 -3.986327 -3.986327  up in  'nlf' 
Fitted param  1 -3.999289  down in  'NLF' 
Fitted param  2 -3.990065 -3.990065  up in  'nlf' 
Fitted param  2 -3.991384  down in  'NLF' 
> 
> se <- p.truth
> se[] <- NA
> se[names(m1$se)] <- m1$se
> print(cbind(truth=p.truth,fit=m1$params,se=se),digits=3)
        truth     fit     se
alpha.1   0.1 -0.2634 0.0894
alpha.2   0.0  0.0000     NA
alpha.3   0.0  0.0000     NA
alpha.4   0.2  0.0389 0.1060
sigma.1   1.0  1.0000     NA
sigma.2   0.0  0.0000     NA
sigma.3   2.0  2.0000     NA
tau       1.0  1.0000     NA
x1.0      0.0  0.0000     NA
x2.0      0.0  0.0000     NA
> 
> po <- simulate(po,times=(1:1000))
> m2 <- nlf(
+           object=po,
+           start=guess,
+           est=c("alpha.1","alpha.4"),
+           lags=c(1,2),
+           nconverge=100,
+           nasymp=10000,
+           method="Nelder-Mead",
+           maxit=500,
+           trace=1,
+           verbose=TRUE,
+           lql.frac = 0.025
+           )
  Nelder-Mead direct search function minimizer
function value for initial parameters = 4016.057678
  Scaled convergence tolerance is 5.98439e-05
Stepsize computed as 0.020000
BUILD              3 4016.416157 4016.057678
REFLECTION         5 4016.318308 4016.057663
EXTENSION          7 4016.057678 4015.676533
LO-REDUCTION       9 4016.057663 4015.676533
REFLECTION        11 4015.681034 4015.580294
HI-REDUCTION      13 4015.676533 4015.580294
REFLECTION        15 4015.581259 4015.556202
HI-REDUCTION      17 4015.580294 4015.537804
LO-REDUCTION      19 4015.556202 4015.537804
HI-REDUCTION      21 4015.539048 4015.537770
HI-REDUCTION      23 4015.537804 4015.533394
HI-REDUCTION      25 4015.537770 4015.532439
LO-REDUCTION      27 4015.533394 4015.532436
HI-REDUCTION      29 4015.532439 4015.532223
HI-REDUCTION      31 4015.532436 4015.532160
HI-REDUCTION      33 4015.532223 4015.532159
Exiting from Nelder Mead minimizer
    35 function evaluations used
h in NLF =  0.1 
epsilon in NLF = 0.4611727 0.2676601 
Fitted param  1 -4.057614 -4.057614  up in  'nlf' 
Fitted param  1 -4.054204  down in  'NLF' 
Fitted param  2 -4.052918 -4.052918  up in  'nlf' 
Fitted param  2 -4.051148  down in  'NLF' 
> 
> se <- p.truth
> se[] <- NA
> se[names(m2$se)] <- m2$se
> print(cbind(truth=p.truth,fit=m2$params,se=se),digits=3)
        truth    fit     se
alpha.1   0.1 0.0349 0.0662
alpha.2   0.0 0.0000     NA
alpha.3   0.0 0.0000     NA
alpha.4   0.2 0.1916 0.0523
sigma.1   1.0 1.0000     NA
sigma.2   0.0 0.0000     NA
sigma.3   2.0 2.0000     NA
tau       1.0 1.0000     NA
x1.0      0.0 0.0000     NA
x2.0      0.0 0.0000     NA
> 
