
R version 2.11.1 (2010-05-31)
Copyright (C) 2010 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(pomp)
> set.seed(1066L)
> 
> data(ou2)
> 
> pm.ou2 <- probe(
+                 ou2,
+                 probes=list(
+                   y1.mean=probe.mean(var="y1"),
+                   y2.mean=probe.mean(var="y2"),
+                   y1.sd=probe.sd(var="y1"),
+                   y2.sd=probe.sd(var="y2")
+                   ),
+                 nsim=500
+                 )
> 
> pm.po <- probe(
+                ou2,
+                params=c(
+                  alpha.1=0.1,alpha.2=-0.5,alpha.3=0.3,alpha.4=0.2,
+                  sigma.1=3,sigma.2=-0.5,sigma.3=2,
+                  tau=1,
+                  x1.0=0,x2.0=0
+                  ),
+                probes=list(
+                  y1.mean=probe.mean(var="y1"),
+                  y2.mean=probe.mean(var="y2"),
+                  y1.sd=probe.sd(var="y1"),
+                  y2.sd=probe.sd(var="y2")
+                  ),
+                nsim=500
+                )
> 
> summary(pm.ou2)
$coef
alpha.1 alpha.2 alpha.3 alpha.4 sigma.1 sigma.2 sigma.3     tau    x1.0    x2.0 
    0.8    -0.5     0.3     0.9     3.0    -0.5     2.0     1.0    -3.0     4.0 

$nsim
[1] 500

$quantiles
y1.mean y2.mean   y1.sd   y2.sd 
  0.122   0.534   0.028   0.042 

$pvals
   y1.mean    y2.mean      y1.sd      y2.sd 
0.24750499 0.93413174 0.05988024 0.08782435 

$synth.loglik
[1] -4.780494

> summary(pm.po)
$coef
alpha.1 alpha.2 alpha.3 alpha.4 sigma.1 sigma.2 sigma.3     tau    x1.0    x2.0 
    0.1    -0.5     0.3     0.2     3.0    -0.5     2.0     1.0     0.0     0.0 

$nsim
[1] 500

$quantiles
y1.mean y2.mean   y1.sd   y2.sd 
  0.078   0.682   1.000   1.000 

$pvals
    y1.mean     y2.mean       y1.sd       y2.sd 
0.159680639 0.638722555 0.003992016 0.003992016 

$synth.loglik
[1] -111.0578

> 
> plot(pm.ou2)
> plot(pm.po)
> 
> pm.ou2 <- probe(
+                 ou2,
+                 probes=list(
+                   y1acf=probe.acf(var="y1",lags=c(0,1,2),type="corr"),
+                   y2acf=probe.acf(var=c("y2"),lags=c(0,1,2)),
+                   y12ccf=probe.ccf(var=c("y2","y1"),lags=c(3,8))
+                   ),
+                 nsim=500
+                 )
Warning message:
In probe.acf(var = "y1", lags = c(0, 1, 2), type = "corr") :
  useless zero lag discarded in 'probe.acf'
>                 
> summary(pm.ou2)
$coef
alpha.1 alpha.2 alpha.3 alpha.4 sigma.1 sigma.2 sigma.3     tau    x1.0    x2.0 
    0.8    -0.5     0.3     0.9     3.0    -0.5     2.0     1.0    -3.0     4.0 

$nsim
[1] 500

$quantiles
y1acf.acf.1.y1 y1acf.acf.2.y1 y2acf.acf.0.y2 y2acf.acf.1.y2 y2acf.acf.2.y2 
         0.098          0.040          0.066          0.068          0.066 
  y12ccf.ccf.3   y12ccf.ccf.8 
         0.052          0.324 

$pvals
y1acf.acf.1.y1 y1acf.acf.2.y1 y2acf.acf.0.y2 y2acf.acf.1.y2 y2acf.acf.2.y2 
    0.19960080     0.08383234     0.13572854     0.13972056     0.13572854 
  y12ccf.ccf.3   y12ccf.ccf.8 
    0.10778443     0.65069860 

$synth.loglik
[1] -9.00962

> 
> pb <- probe(
+             ou2,
+             probes=list(
+               y1=probe.quantile(var="y1",prob=seq(0.1,0.9,by=0.1)),
+               probe.acf(var=c("y1","y2"),lags=c(0,1,4,7),transform=identity),
+               pd=probe.period(var="y1",kernel.width=3)
+               ),
+             nsim=200
+             )
> summary(pb)
$coef
alpha.1 alpha.2 alpha.3 alpha.4 sigma.1 sigma.2 sigma.3     tau    x1.0    x2.0 
    0.8    -0.5     0.3     0.9     3.0    -0.5     2.0     1.0    -3.0     4.0 

$nsim
[1] 200

$quantiles
  y1.10%   y1.20%   y1.30%   y1.40%   y1.50%   y1.60%   y1.70%   y1.80% 
   0.730    0.770    0.770    0.545    0.355    0.135    0.020    0.010 
  y1.90% acf.0.y1 acf.1.y1 acf.4.y1 acf.7.y1 acf.0.y2 acf.1.y2 acf.4.y2 
   0.000    0.030    0.035    0.835    0.860    0.070    0.075    0.465 
acf.7.y2       pd 
   0.840    0.100 

$pvals
     y1.10%      y1.20%      y1.30%      y1.40%      y1.50%      y1.60% 
0.547263682 0.467661692 0.467661692 0.915422886 0.716417910 0.278606965 
     y1.70%      y1.80%      y1.90%    acf.0.y1    acf.1.y1    acf.4.y1 
0.049751244 0.029850746 0.009950249 0.069651741 0.079601990 0.338308458 
   acf.7.y1    acf.0.y2    acf.1.y2    acf.4.y2    acf.7.y2          pd 
0.288557214 0.149253731 0.159203980 0.935323383 0.328358209 0.208955224 

$synth.loglik
[1] -26.82926

> 
> po <- ou2
> coef(po,c("alpha.2","alpha.3")) <- c(0,0)
> coef(po,c("sigma.2","sigma.1","sigma.3")) <- c(0,0.0,0.0)
> coef(po,c("tau")) <- c(0.0)
> po <- simulate(po)
> pb <- probe(
+             po,
+             probes=list(
+               probe.acf(var=c("y1","y2"),lags=c(0,1),type="cor"),
+               probe.nlar("y1",lags=1,powers=1),
+               probe.nlar("y2",lags=1,powers=1)
+               ),
+             nsim=1000,
+             seed=1066L
+             )
Warning message:
In probe.acf(var = c("y1", "y2"), lags = c(0, 1), type = "cor") :
  useless zero lag discarded in 'probe.acf'
> x <- as.data.frame(po)
> x <- sweep(x,2,mean(x))
> y1 <- head(x$y1,-1)
> z1 <- tail(x$y1,-1)
> y2 <- head(x$y2,-1)
> z2 <- tail(x$y2,-1)
> max(abs(pb@datvals-c(mean(y1*z1)/mean(x$y1^2),mean(y2*z2)/mean(x$y2^2),mean(y1*z1)/mean(y1*y1),mean(y2*z2)/mean(y2*y2))))
[1] 4.440892e-16
> 
> po <- simulate(ou2)
> pb <- probe(
+             po,
+             probes=list(
+               probe.acf(var=c("y1"),lags=c(0,1,2),type="cov"),
+               probe.ccf(vars=c("y1","y1"),lags=c(0,1,2),type="cov")
+               ),
+             nsim=1000,
+             seed=1066L
+             )
> plot(pb)
> summary(pb)
$coef
alpha.1 alpha.2 alpha.3 alpha.4 sigma.1 sigma.2 sigma.3     tau    x1.0    x2.0 
    0.8    -0.5     0.3     0.9     3.0    -0.5     2.0     1.0    -3.0     4.0 

$nsim
[1] 1000

$quantiles
acf.0.y1 acf.1.y1 acf.2.y1    ccf.0    ccf.1    ccf.2 
   0.850    0.853    0.840    0.850    0.853    0.840 

$pvals
 acf.0.y1  acf.1.y1  acf.2.y1     ccf.0     ccf.1     ccf.2 
0.3016983 0.2957043 0.3216783 0.3016983 0.2957043 0.3216783 

$synth.loglik
[1] 86.8972

> 
> pb <- probe(
+             po,
+             probes=probe.ccf(vars=c("y1","y2"),lags=c(-5,-3,1,4,8)),
+             nsim=1000,
+             seed=1066L
+             )
> plot(pb)
> summary(pb)
$coef
alpha.1 alpha.2 alpha.3 alpha.4 sigma.1 sigma.2 sigma.3     tau    x1.0    x2.0 
    0.8    -0.5     0.3     0.9     3.0    -0.5     2.0     1.0    -3.0     4.0 

$nsim
[1] 1000

$quantiles
ccf.-5 ccf.-3  ccf.1  ccf.4  ccf.8 
 0.834  0.860  0.149  0.164  0.929 

$pvals
   ccf.-5    ccf.-3     ccf.1     ccf.4     ccf.8 
0.3336663 0.2817183 0.2997003 0.3296703 0.1438561 

$synth.loglik
[1] -14.9071

> 
> pb <- probe(
+             po,
+             probes=probe.ccf(vars=c("y1","y2"),lags=c(-5,-3,1,4,8),type="corr"),
+             nsim=1000,
+             seed=1066L
+             )
> plot(pb)
> summary(pb)
$coef
alpha.1 alpha.2 alpha.3 alpha.4 sigma.1 sigma.2 sigma.3     tau    x1.0    x2.0 
    0.8    -0.5     0.3     0.9     3.0    -0.5     2.0     1.0    -3.0     4.0 

$nsim
[1] 1000

$quantiles
ccf.-5 ccf.-3  ccf.1  ccf.4  ccf.8 
 0.693  0.821  0.346  0.243  0.850 

$pvals
   ccf.-5    ccf.-3     ccf.1     ccf.4     ccf.8 
0.6153846 0.3596404 0.6933067 0.4875125 0.3016983 

$synth.loglik
[1] 7.363337

> 
> head(as(pb,"data.frame"))
         ccf.-5    ccf.-3      ccf.1      ccf.4        ccf.8
data  0.6340061 0.8339776 -0.3925899 -0.7963667  0.301628540
sim.1 0.4470813 0.8292044 -0.3798152 -0.7420235  0.519633798
sim.2 0.5461973 0.7227145 -0.2996333 -0.6294983  0.012241523
sim.3 0.4229191 0.7283615 -0.1026817 -0.5565477 -0.115334617
sim.4 0.4577827 0.7103028 -0.3372048 -0.5293968 -0.020542485
sim.5 0.4013560 0.6594786 -0.2933890 -0.5947615 -0.001712792
> 
> 
> 
