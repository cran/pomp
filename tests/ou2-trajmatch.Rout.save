
R version 2.10.1 (2009-12-14)
Copyright (C) 2009 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(pomp)
Loading required package: deSolve
Loading required package: subplex
Loading required package: mvtnorm
> 
> data(ou2)
> true.p <- c(
+             alpha.1=0.9,alpha.2=0,alpha.3=0,alpha.4=0.99,
+             sigma.1=1,sigma.2=0,sigma.3=2,
+             tau=1,x1.0=50,x2.0=-50
+             )
> simdata <- simulate(ou2,nsim=5,params=true.p,seed=394885)
> guess.p <- true.p
> guess.p[grep('sigma',names(guess.p))] <- 0
> 
> x <- sapply(
+             simdata,
+             function (d) {
+               res <- traj.match(
+                                 d,
+                                 start=guess.p,
+                                 est=c('alpha.1','alpha.4','x1.0','x2.0','tau'),
+                                 maxit=2000,
+                                 reltol=1e-8
+                                 )
+               c(conv=res$convergence,loglik=res$value,res$params)
+             }
+             )
> range(x['conv',])
[1] 0 0
> range(x['loglik',])
[1] -590.7141 -507.0953
> print(
+       cbind(
+             truth=true.p,
+             mean.est=apply(x[names(true.p),],1,mean),
+             bias=apply(x[names(true.p),],1,mean)-true.p,
+             se=apply(x[names(true.p),],1,sd)
+             ),
+       digits=4
+       )
         truth mean.est      bias       se
alpha.1   0.90   0.9110  0.010953 0.022026
alpha.2   0.00   0.0000  0.000000 0.000000
alpha.3   0.00   0.0000  0.000000 0.000000
alpha.4   0.99   0.9935  0.003476 0.002373
sigma.1   1.00   0.0000 -1.000000 0.000000
sigma.2   0.00   0.0000  0.000000 0.000000
sigma.3   2.00   0.0000 -2.000000 0.000000
tau       1.00   3.6906  2.690637 0.724948
x1.0     50.00  47.2476 -2.752419 5.299588
x2.0    -50.00 -48.8198  1.180172 5.418218
> 
