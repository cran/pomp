
R version 2.11.1 (2010-05-31)
Copyright (C) 2010 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(pomp)
> 
> data(ricker)
> 
> set.seed(64857673L)
> 
> po <- ricker
> coef(po) <- c(log.r=log(2),log.sigma=log(1),log.phi=log(20),N.0=7,e.0=0)
> 
> pf.tr <- pfilter(ricker,Np=1000,max.fail=50)
> pf.po <- pfilter(po,Np=1000,max.fail=50)
> 
> mf <- mif(
+           po,
+           Nmif=100,
+           Np=1000,
+           cooling.factor=0.99,
+           var.factor=2,
+           ic.lag=3,
+           max.fail=50,
+           rw.sd=c(log.r=0.1,log.sigma=0.1,log.phi=0.1)
+           )
> plot(mf <- mif(mf,Nmif=500,max.fail=20))
> pf.mf <- pfilter(mf,Np=1000)
> 
> res <- rbind(
+              cbind(truth=coef(ricker),MLE=coef(mf),guess=coef(po)),
+              loglik=c(pf.tr$loglik,pf.mf$loglik,pf.po$loglik)
+              )
> 
> print(res,digits=3)
            truth     MLE    guess
log.r        3.80    3.81    0.693
log.sigma   -1.20   -1.73    0.000
log.phi      2.30    2.32    2.996
N.0          7.00    7.00    7.000
e.0          0.00    0.00    0.000
loglik    -139.22 -137.14 -268.810
> 
> tj.1 <- trajectory(ricker)
Warning message:
The default behavior of 'trajectory' has changed.
See the documentation ("pomp?trajectory") for details
and set the 'times' and 't0' arguments appropriately to compensate.
 
> plot(time(ricker),tj.1[1,,],type='l')
> tj.2 <- trajectory(ricker,times=c(30:50),t0=0)
> lines(30:50,tj.2[1,,],col='red',lwd=2)
> max(abs(tj.1[,,time(ricker)>=30]-tj.2[,,]))
[1] 0
> 
> data(ricker)
> po <- ricker
> try(
+     coef(po,"r")
+     )
Error in .local(object, ...) : 
  in 'coef': name(s) 'r' correspond to no parameter(s)
> coef(po,c("r","phi")) <- c(0,0)
Warning message:
in 'coef<-': name(s) 'r','phi' are not existing parameter(s); they are being concatenated 
> coef(po,c("log.r","log.phi")) <- c(a=0,b=0)
Warning message:
in 'coef<-': names of 'value' are being discarded 
> coef(po,c("log.r","log.phi")) <- 0
> coef(po) <- c(log.phi=0,log.r=3.5,N.0=10,e.0=0,log.sigma=-Inf)
> coef(po)
  log.phi     log.r       N.0       e.0 log.sigma 
      0.0       3.5      10.0       0.0      -Inf 
> coef(po,"new") <- 3
Warning message:
in 'coef<-': name(s) 'new' are not existing parameter(s); they are being concatenated 
> plot(simulate(po))
> coef(po)
  log.phi     log.r       N.0       e.0 log.sigma       new 
      0.0       3.5      10.0       0.0      -Inf       3.0 
> 
