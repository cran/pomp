
R version 2.12.2 (2011-02-25)
Copyright (C) 2011 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(pomp)
Loading required package: mvtnorm
Loading required package: subplex
Loading required package: deSolve
> 
> pdf.options(useDingbats=FALSE)
> pdf(file="fhn.pdf")
> 
> ## autonomous case
> fhn <- pomp(
+             data=data.frame(time=seq(0,60,by=0.1),Vobs=NA),
+             times="time",
+             t0=-0.1,
+             skeleton.type="vectorfield",
+             skeleton=function(x,t,params,...) {
+               with(
+                    as.list(c(x,params)),
+                    c(
+                      V=c*(V-V^3/3-R+i),
+                      R=(V+a-b*R)/c
+                      )
+                    )
+             }
+             )
> 
> x <- array(c(0,1,1,2,1,1,0,-1),dim=c(2,2,2),dimnames=list(c("V","R"),NULL,NULL))
> params <- rbind(a=c(0.7,0.5),b=c(0.8,0.5),c=c(2,5),V.0=c(1,1),R.0=c(0,0),i=c(0.8,0))
> skeleton(fhn,x,t=c(0,3),params=params)
, , 1

   [,1]      [,2]
V -0.40 -6.666667
R -0.05  0.100000

, , 2

       [,1] [,2]
V 0.9333333  5.0
R 0.4500000  0.2

> y <- trajectory(fhn,params=params,hmax=0.1)
> y[,,599:601]
, , 1

       [,1]       [,2]
V 1.7086515 -1.9257830
R 0.9468273  0.4306572

, , 2

      [,1]       [,2]
V 1.684666 -1.9136647
R 1.027194  0.3981193

, , 3

      [,1]       [,2]
V 1.654967 -1.9015481
R 1.103084  0.3661463

> matplot(time(fhn),t(y["V",,]),type='l',lty=1)
> plot(y[1,,],y[2,,],type='n')
> points(y[1,1,],y[2,1,],pch='.',cex=3,col='black')
> points(y[1,2,],y[2,2,],pch='.',cex=3,col='red')
> 
> ## nonautonomous case
> fhn <- pomp(
+             data=data.frame(time=seq(0,20,by=0.1),Vobs=NA),
+             times="time",
+             t0=0,
+             tcovar=seq(0,21,by=0.1),
+             covar=cbind(i=sin(2*pi*seq(0,21,by=0.1))),
+             skeleton.vectorfield=function(x,t,params,covars,...) {
+               c(
+                 V=unname(params['c']*(x['V']-(x['V']^3)/3-x['R']+covars['i'])),
+                 R=unname((x['V']+params['a']-params['b']*x['R'])/params['c'])
+                 )
+             }
+             )
Warning message:
the arguments 'skeleton.map' and 'skeleton.vectorfield' are now deprecated. Use 'skeleton' and 'skeleton.type' instead. 
> 
> skeleton(fhn,x,t=c(0,3),params=params)
, , 1

   [,1]      [,2]
V -2.00 -6.666667
R -0.05  0.100000

, , 2

        [,1] [,2]
V -0.6666667  5.0
R  0.4500000  0.2

> y <- trajectory(fhn,params=params,hmax=0.01)
> y[,,199:201]
, , 1

        [,1]        [,2]
V -1.3052919  1.27398107
R -0.5591608 -0.00692014

, , 2

        [,1]       [,2]
V -1.4459045 1.19170161
R -0.5707824 0.02732499

, , 3

       [,1]       [,2]
V -1.471404 1.32437192
R -0.586106 0.06164339

> matplot(time(fhn),t(y["V",,]),type='l',lty=1)
> plot(y[1,,],y[2,,],type='n')
> points(y[1,1,],y[2,1,],pch='.',cex=3,col='black')
> points(y[1,2,],y[2,2,],pch='.',cex=3,col='red')
> 
> dev.off()
null device 
          1 
> 
